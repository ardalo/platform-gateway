plugins {
  id "com.github.ben-manes.versions" version "0.36.0"
  id "groovy"
  id "io.spring.dependency-management" version "1.0.10.RELEASE"
  id "jacoco"
  id "java"
  id "org.sonarqube" version "3.0"
  id "org.springframework.boot" version "2.4.1"
}

java {
  group = "com.ardalo.digitalplatform"
  sourceCompatibility = JavaVersion.VERSION_11
  targetCompatibility = JavaVersion.VERSION_11
}

repositories {
  mavenCentral()
  // necessary as long as org.springframework.cloud:spring-cloud-dependencies uses a milestone version
  maven { url 'https://repo.spring.io/milestone' }
}

sonarqube {
  properties {
    property "sonar.projectKey", "ardalo_platform-gateway"
    property "sonar.organization", "ardalo"
    property "sonar.host.url", "https://sonarcloud.io"
    property "sonar.coverage.jacoco.xmlReportPaths", "build/reports/jacoco/test/jacocoTestReport.xml"
  }
}

jacocoTestReport {
  reports {
    xml.enabled true
  }
}

dependencies {
  implementation "io.micrometer:micrometer-registry-prometheus:1.6.2"
  implementation "io.springfox:springfox-boot-starter:3.0.0"
  implementation "net.logstash.logback:logstash-logback-encoder:6.5"
  implementation "org.springframework.boot:spring-boot-starter-actuator"
  implementation "org.springframework.cloud:spring-cloud-starter-gateway"
  // Version of com.squareup.okhttp3:mockwebserver must by in sync with com.squareup.okhttp3:okhttp3 from org.springframework.boot Gradle Plugin
  testImplementation "com.squareup.okhttp3:mockwebserver:3.14.9"
  testImplementation "org.codehaus.groovy:groovy-all:3.0.7"
  testImplementation "org.spockframework:spock-core:1.3-groovy-2.5"
  testImplementation "org.spockframework:spock-spring:1.3-groovy-2.5"
  testImplementation "org.springframework.boot:spring-boot-starter-test"
}

dependencyManagement {
	imports {
		mavenBom "org.springframework.cloud:spring-cloud-dependencies:2020.0.0-RC1"
	}
}
